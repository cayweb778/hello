# 子模块集成（与开发环境无关，纯生产环境集成）

### 子模块免登陆逻辑（内嵌iframe或外挂,openId方式）
- nc的用户信息中的openId,可以下发到子模块中
- 子模块检查到当前处于NC网关模式（判定方式：当前登陆页处于iframe中,路径参数包含openId）
- 直接进入网关页面（position:fix,满屏）
- 子模块判定：没有则绑定或注册（走NC的注册API）,有则直接登陆
- 免登陆网关和注册和登陆

### 定义安全等级
- 10[高安全]
- 9
- 8
- 7
- 6
- 5[当前位置]
- 4
- 3
- 2
- 1[低安全]

## 子模块集成方式
1. 内嵌子模块【推荐】[安全等级5]：
   - 前端引入NcLoginHook.js（必须）
   - API：子模块登陆接口,子模块注册接口
   - 子模块场景：vue3,vue2,jsp,spring security
2. 外挂[安全等级2-3]
   - 直接浏览器新页签，跳转传参openid,code(安全码)
3. 微前端[安全等级5以上]
   - （目前技术复杂度高，需要调整子模块量大，以适合自身软件体系）

### 内嵌子模块【推荐】原理
- 通过给iframe下发code,openId
- 子模块登陆前校验
  - 请求NC接口，检查是否消费
    - 消费过，则不允许子模块登陆，没消费过code，则继续登陆